int do_hash(const unsigned char *data, unsigned char *digest);